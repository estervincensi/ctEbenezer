<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
	lang="en" layout:decorator="/layouts/main">


<body>
	<div layout:fragment="content">
		<div class="right_col" role="main">
			<div class="x_content dashboard_graph">
				
				 <!--Div that will hold the dashboard-->
    			<div id="dashboard_div">
      				<!--Divs that will hold each control and chart-->
      				<div id="filter_div"></div>
      				<div id="chart_div"></div>
    			</div>

			</div>
		</div>
	</div>

	<th:block layout:fragment="js-view">
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript">

		  // Load the Visualization API and the controls package.
		  // Packages for all the other charts you need will be loaded
		  // automatically by the system.
		  google.charts.load('current', {'packages':['corechart', 'controls']});
		
		  // Set a callback to run when the Google Visualization API is loaded.
		  google.charts.setOnLoadCallback(drawDashboard);
		
		  function drawDashboard() {
		    // Everything is loaded. Assemble your dashboard...
			  var jsonString;
		    $.get("/relatorio/chart", function(data, status){
			        jsonString = data;
			    });
		       var jsonData = JSON.parse(jsonString);
		      // Create our data table out of JSON data loaded from server.
		      var data = new google.visualization.DataTable(jsonData);
		      var dashboard = new google.visualization.Dashboard(document.getElementById('dashboard_div'));
		   // Create a range slider, passing some options
		      var donutRangeSlider = new google.visualization.ControlWrapper({
		        'controlType': 'NumberRangeFilter',
		        'containerId': 'filter_div',
		        'options': {
			          'filterColumnLabel': 'id'
			    }
		      });

		      // Create a pie chart, passing some options
		      var pieChart = new google.visualization.ChartWrapper({
		        'chartType': 'PieChart',
		        'containerId': 'chart_div',
		        'options': {
		          'width': 300,
		          'height': 300,
		          'pieSliceText': 'label'
		        }
		      });
		      dashboard.bind(donutRangeSlider, pieChart);
		      dashboard.draw(data);

		  }
		  
		</script>
	</th:block>
</body>
</html>